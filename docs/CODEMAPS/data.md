# Data Models Codemap

**Last Updated:** 2026-02-16
**Storage:** Neon Postgres (primary), Cloudflare D1 (legacy), localStorage (fallback)

## Data Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Data Layer                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
        â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Neon DB     â”‚  â”‚  D1 Database â”‚  â”‚ localStorage  â”‚
â”‚  (Primary)   â”‚  â”‚  (Legacy)    â”‚  â”‚  (Fallback)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - settings   â”‚  â”‚ - settings   â”‚  â”‚ - lpf2-*     â”‚
â”‚ - sites      â”‚  â”‚ - sites      â”‚    - settings   â”‚
â”‚ - deploy_    â”‚  â”‚ - deploy_    â”‚    - sites      â”‚
â”‚   history    â”‚  â”‚   history    â”‚    - deployUrls â”‚
â”‚              â”‚  â”‚ - accounts   â”‚    - deploy-    â”‚
â”‚  HTTP API    â”‚  â”‚ - payments   â”‚    - configs    â”‚
â”‚  (@neondatabase/â”‚              â”‚                 â”‚
â”‚   serverless) â”‚  SQLite API   â”‚  Browser API   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Core Data Models

### Site Model

Represents a generated landing page configuration.

```typescript
interface Site {
  // Identity
  id: string;              // UUID, generated by uid()
  brand: string;           // e.g., "LoanBridge"
  domain: string;          // e.g., "loanbridge.com"
  tagline?: string;        // e.g., "Fast. Simple. Trusted."
  email?: string;          // Compliance email

  // Product Configuration
  loanType: LoanType;      // 'personal' | 'installment' | 'pet' | 'medical' | 'auto' | 'custom'
  amountMin: number;       // e.g., 100
  amountMax: number;       // e.g., 5000
  aprMin: number;          // e.g., 5.99
  aprMax: number;          // e.g., 35.99

  // Design
  colorId: ColorId;        // 'ocean' | 'forest' | 'midnight' | ...
  fontId: FontId;          // 'dm-sans' | 'plus-jakarta' | ...
  layout: LayoutId;        // 'hero-left' | 'hero-center' | 'hero-full'
  radius: RadiusId;        // 'sharp' | 'subtle' | 'rounded' | 'pill'

  // Copy
  h1?: string;             // Main headline
  badge?: string;          // Trust badge text
  cta?: string;            // Button text
  sub?: string;            // Sub-headline

  // Tracking
  gtmId?: string;          // GTM container ID
  conversionId?: string;   // Google Ads conversion ID
  conversionLabel?: string;
  voluumId?: string;       // Voluum pixel ID
  voluumDomain?: string;
  network: Network;        // 'LeadsGate' | 'ZeroParallel' | ...
  redirectUrl: string;     // Affiliate destination
  formEmbed?: string;      // Embedded form HTML

  // State
  status?: 'completed' | 'draft';
  createdAt: string;       // ISO timestamp
  cost?: number;           // Build cost estimate
}
```

### Deployment Model

```typescript
interface Deployment {
  id: string;              // Unique deployment ID
  siteId: string;          // Reference to Site.id
  domain: string;          // Deployed domain
  brand: string;           // Site brand name
  target: DeployTarget;    // 'cf-pages' | 'netlify' | 'vercel' | 'cf-workers' | 's3-cloudfront' | 'vps-ssh'
  url: string;             // Deployed URL
  status: 'pending' | 'success' | 'failed';
  environment: 'production' | 'staging' | 'dev';
  deployId?: string;       // Platform-specific deployment ID
  durationMs?: number;     // Deployment duration
  errorMessage?: string;   // Error details if failed
  dnsUpdated?: boolean;    // Whether DNS was updated
  dnsError?: string;       // DNS error details
  ts: string;              // ISO timestamp
}
```

### Account Model (Operations)

```typescript
interface Account {
  id: string;
  label: string;
  email?: string;
  paymentId?: string;      // Reference to payment card
  budget?: number;
  status: 'active' | 'suspended' | 'blocked';
  cardUuid?: string;       // LeadingCards card UUID
  cardLast4?: string;
  cardStatus?: string;
  profileId?: string;      // Multilogin profile ID
  proxyIp?: string;
  monthlySpend?: number;
  created_at: string;
}
```

### Payment Card Model

```typescript
interface PaymentCard {
  id: string;
  label: string;
  cardUuid?: string;       // LeadingCards UUID
  cardLast4?: string;
  cardStatus: 'active' | 'blocked' | 'expired';
  billingId?: string;      // Billing address UUID
  binId?: string;          // BIN UUID
  limit?: number;          // Card limit
  spend?: number;          // Current spend
  teamId?: string;
  created_at: string;
}
```

### Domain Model

```typescript
interface Domain {
  id: string;
  domain: string;          // e.g., "example.com"
  registrar: Registrar;    // 'Namecheap' | 'GoDaddy' | 'Cloudflare' | 'Porkbun' | 'Other'
  status: 'active' | 'expired' | 'transferred';
  autoRenew?: boolean;
  expiresAt?: string;      // ISO date
  notes?: string;
  created_at: string;
}
```

### Settings Model

```typescript
interface Settings {
  // Database
  neonUrl?: string;        // Neon Postgres connection string

  // AI
  apiKey?: string;         // Anthropic API key
  geminiKey?: string;      // Gemini API key

  // Deployment - Cloudflare
  cfApiToken?: string;
  cfAccountId?: string;    // 32-char hex

  // Deployment - Netlify
  netlifyToken?: string;

  // Deployment - Vercel
  vercelToken?: string;

  // Deployment - AWS
  awsAccessKey?: string;
  awsSecretKey?: string;
  awsRegion?: string;
  s3Bucket?: string;
  cloudfrontDistId?: string;

  // Deployment - VPS
  vpsHost?: string;
  vpsPort?: string;
  vpsUser?: string;
  vpsPath?: string;
  vpsAuthMethod?: 'key' | 'password';
  vpsKey?: string;
  vpsWorkerUrl?: string;

  // LeadingCards
  lcToken?: string;
  lcTeamUuid?: string;
  defaultBinUuid?: string;
  defaultBillingUuid?: string;

  // Multilogin X
  mlToken?: string;
  mlEmail?: string;
  mlPassword?: string;
  mlFolderId?: string;
  defaultProxyProvider?: 'multilogin' | 'custom';
}
```

## Constants

### Loan Types
```javascript
LOAN_TYPES = [
  { id: 'personal', label: 'Personal Loans', icon: 'ğŸ’³' },
  { id: 'installment', label: 'Installment Loans', icon: 'ğŸ“‹' },
  { id: 'pet', label: 'Pet Care Financing', icon: 'ğŸ¾' },
  { id: 'medical', label: 'Medical Financing', icon: 'ğŸ¥' },
  { id: 'auto', label: 'Auto Loans', icon: 'ğŸš—' },
  { id: 'custom', label: 'Custom / Other', icon: 'âš¡' },
]
```

### Color Schemes (8 presets)
Each color has primary (p), secondary (s), accent (a), background (bg), foreground (fg) in HSL format.

### Fonts (8 Google Fonts)
- DM Sans, Plus Jakarta Sans, Outfit, Manrope, Sora, Figtree, Inter, Space Grotesk

### Layouts
- `hero-left` - Classic split with form on right
- `hero-center` - Centered with form below
- `hero-full` - Full width hero

### Border Radius
- `sharp` - 0rem
- `subtle` - 0.375rem
- `rounded` - 0.75rem
- `pill` - 1.5rem

### Affiliate Networks
- LeadsGate, ZeroParallel, LeadStack, ClickDealer, Everflow, Custom

### DNS Record Types
A, AAAA, CNAME, TXT, MX, NS, SRV, CAA

### DNS Templates
- landing-page, email-google, wordpress, saas, cdn-static, dkim-email, cloudflare-pages, netlify, vercel

## Data Access Patterns

### Neon (Primary)
```javascript
import * as db from './services/neon';

// Initialize
db.initNeon(connectionString);

// CRUD
await db.saveSettings({ apiKey: '...' });
await db.loadSettings();
await db.saveSite(site);
await db.loadSites();
await db.deleteSite(id);
await db.saveDeploy(deploy);
await db.loadDeploys();
```

### LocalStorage (Fallback)
```javascript
import { LS } from './utils';

LS.get('settings');      // Get
LS.set('settings', obj); // Set
```

### API (Legacy)
```javascript
import { api } from './services/api';

const data = await api.get('/init');
await api.post('/sites', site);
await api.put(`/sites/${id}`, updates);
await api.del(`/sites/${id}`);
```

## Related Files

- `src/constants/index.js` - All constant definitions
- `src/services/neon.js` - Neon data access layer
- `src/services/api.js` - API client wrapper
- `src/utils/index.js` - LocalStorage helpers
